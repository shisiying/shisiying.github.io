<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="努力，奋斗！"><title>laravel学习之服务提供者 | 其斤.匕禾页</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">laravel学习之服务提供者</h1><a id="logo" href="/.">其斤.匕禾页</a><p class="description">站在巨人的肩膀上，做只勤奋的小蜜蜂！</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/2018/10/02/lnmp技术栈文章汇总/"><i class="fa fa-archive"> LNMP技术栈</i></a><a href="/2018/10/02/速读laravel源码/"><i class="fa fa-archive"> laravel框架学习</i></a><a href="https://zhimap.com/mmap/773f7025d57f4c24b3c680bd9972c7e8"><i class="fa fa-archive"> 秒杀系统学习</i></a><a href="/2018/09/22/408基础/"><i class="fa fa-archive"> 计算机基础</i></a><a href="/2018/09/17/resume/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">laravel学习之服务提供者</h1><div class="post-meta">Oct 10, 2018<span> | </span><span class="category"><a href="/categories/php/">php</a></span></div><div class="post-content"><a id="more"></a>
<p>服务提供者是所有 Laravel 应用程序引导中心。你的应用程序自定义的服务、第三方资源包提供的服务以及 Laravel 的所有核心服务都是通过服务提供器进行注册(register)和引导(boot)的。</p>
<p>比如我之前开发的简单的第三方资源包-<a href="https://github.com/shisiying/sevenshi-serverchan" target="_blank" rel="noopener">一个基于server酱推送服务的laravel package,包含一对一和一对多推送</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">namespace Sevenshi\Serverchan;</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: seven</span><br><span class="line"> * Date: 2018/7/17</span><br><span class="line"> * Time: 17:30</span><br><span class="line"> */</span><br><span class="line">use Illuminate\Support\ServiceProvider;</span><br><span class="line">class SevenServiceProvider extends ServiceProvider</span><br><span class="line">&#123;</span><br><span class="line">    protected <span class="variable">$defer</span> = <span class="literal">true</span>;</span><br><span class="line">    public <span class="keyword">function</span> boot()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;publishes([</span><br><span class="line">            __DIR__.<span class="string">'/../config/serverchan.php'</span> =&gt; config_path(<span class="string">'serverchan.php'</span>),</span><br><span class="line">        ], <span class="string">'serverchan'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">function</span> register()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;mergeConfigFrom( __DIR__.<span class="string">'/../config/serverchan.php'</span>, <span class="string">'serverchan'</span>);</span><br><span class="line">        <span class="variable">$this</span>-&gt;app-&gt;singleton(<span class="string">'serverchan'</span>, <span class="keyword">function</span> (<span class="variable">$app</span>) &#123;</span><br><span class="line">            <span class="variable">$config</span> = <span class="variable">$app</span>-&gt;make(<span class="string">'config'</span>);</span><br><span class="line">            <span class="variable">$SCKEY</span> = <span class="variable">$config</span>-&gt;get(<span class="string">'serverchan.SCKEY'</span>);</span><br><span class="line">            <span class="built_in">return</span> new SevenService(<span class="variable">$SCKEY</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">function</span> <span class="function"><span class="title">provides</span></span>() &#123;</span><br><span class="line">        <span class="built_in">return</span> [<span class="string">'serverchan'</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>具体怎么编写服务提供器可看<a href="https://laravel-china.org/docs/laravel/5.5/providers/1290#deferred-providers" target="_blank" rel="noopener">文档</a></p>
<p>接下来我们可以由服务提供者来讲，laravel是如何注册、和初始化这些服务的，前面我们提到laravel的生命周期</p>
<p><img src="laravel生命周期.png" alt="laravel生命周期"></p>
<p>从图我们可以看到laravel注册和引导应用需要的服务是发生在请求处理工作阶段，在框架的入口文件里我们可以看到，框架在实例化了Application对象后从服务容器中解析出了HTTP Kernel对象</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable">$kernel</span> = <span class="variable">$app</span>-&gt;make(Illuminate\Contracts\Http\Kernel::class);</span><br><span class="line"></span><br><span class="line"><span class="variable">$response</span> = <span class="variable">$kernel</span>-&gt;handle(</span><br><span class="line">    <span class="variable">$request</span> = Illuminate\Http\Request::capture()</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>在Kernel处理请求时会先让请求通过中间件然后在发送请求给路由对应的控制器方法， 在这之前有一个BootStrap阶段来引导启动Laravel应用程序，如下面代码所示。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">function</span> handle(<span class="variable">$request</span>)</span><br><span class="line">&#123;</span><br><span class="line">    ......</span><br><span class="line">    <span class="variable">$response</span> = <span class="variable">$this</span>-&gt;sendRequestThroughRouter(<span class="variable">$request</span>);</span><br><span class="line">    ......</span><br><span class="line">            </span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$response</span>;</span><br><span class="line">&#125;</span><br><span class="line">protected <span class="keyword">function</span> sendRequestThroughRouter(<span class="variable">$request</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$this</span>-&gt;app-&gt;instance(<span class="string">'request'</span>, <span class="variable">$request</span>);</span><br><span class="line"></span><br><span class="line">    Facade::clearResolvedInstance(<span class="string">'request'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$this</span>-&gt;bootstrap();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> (new Pipeline(<span class="variable">$this</span>-&gt;app))</span><br><span class="line">                    -&gt;send(<span class="variable">$request</span>)</span><br><span class="line">                    -&gt;through(<span class="variable">$this</span>-&gt;app-&gt;shouldSkipMiddleware() ? [] : <span class="variable">$this</span>-&gt;middleware)</span><br><span class="line">                    -&gt;<span class="keyword">then</span>(<span class="variable">$this</span>-&gt;dispatchToRouter());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>//引导启动Laravel应用程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">function</span> bootstrap()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (! <span class="variable">$this</span>-&gt;app-&gt;hasBeenBootstrapped()) &#123;</span><br><span class="line">	/**依次执行<span class="variable">$bootstrappers</span>中每一个bootstrapper的bootstrap()函数</span><br><span class="line">        <span class="variable">$bootstrappers</span> = [</span><br><span class="line">             <span class="string">'Illuminate\Foundation\Bootstrap\DetectEnvironment'</span>,</span><br><span class="line">             <span class="string">'Illuminate\Foundation\Bootstrap\LoadConfiguration'</span>,</span><br><span class="line">             <span class="string">'Illuminate\Foundation\Bootstrap\ConfigureLogging'</span>,</span><br><span class="line">             <span class="string">'Illuminate\Foundation\Bootstrap\HandleExceptions'</span>,</span><br><span class="line">             <span class="string">'Illuminate\Foundation\Bootstrap\RegisterFacades'</span>,</span><br><span class="line">             <span class="string">'Illuminate\Foundation\Bootstrap\RegisterProviders'</span>,</span><br><span class="line">             <span class="string">'Illuminate\Foundation\Bootstrap\BootProviders'</span>,</span><br><span class="line">            ];*/</span><br><span class="line">            <span class="variable">$this</span>-&gt;app-&gt;bootstrapWith(<span class="variable">$this</span>-&gt;bootstrappers());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面bootstrap中会分别执行每一个bootstrapper的bootstrap方法来引导启动应用程序的各个部分</p>
<ul>
<li>DetectEnvironment  检查环境</li>
<li>LoadConfiguration  加载应用配置</li>
<li>ConfigureLogging   配置日至</li>
<li>HandleException    注册异常处理的Handler</li>
<li>RegisterFacades    注册Facades </li>
<li>RegisterProviders  注册Providers </li>
<li>BootProviders      启动Providers</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">namespace Illuminate\Foundation;</span><br><span class="line"></span><br><span class="line">class Application extends Container implements ...</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="keyword">function</span> bootstrapWith(array <span class="variable">$bootstrappers</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;hasBeenBootstrapped = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        foreach (<span class="variable">$bootstrappers</span> as <span class="variable">$bootstrapper</span>) &#123;</span><br><span class="line">            <span class="variable">$this</span>[<span class="string">'events'</span>]-&gt;fire(<span class="string">'bootstrapping: '</span>.<span class="variable">$bootstrapper</span>, [<span class="variable">$this</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="variable">$this</span>-&gt;make(<span class="variable">$bootstrapper</span>)-&gt;bootstrap(<span class="variable">$this</span>);</span><br><span class="line"></span><br><span class="line">            <span class="variable">$this</span>[<span class="string">'events'</span>]-&gt;fire(<span class="string">'bootstrapped: '</span>.<span class="variable">$bootstrapper</span>, [<span class="variable">$this</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>启动应用程序的最后两部就是注册服务提供这和启动提供者，如果对前面几个阶段具体时怎么实现的可以参考这篇文章<a href="https://segmentfault.com/a/1190000006946685#articleHeader5" target="_blank" rel="noopener">Laravel学习笔记之bootstrap源码解析</a>。在这里我们主要关注服务提供器的注册和启动。</p>
<p>先来看注册服务提供器，服务提供器的注册由类 \Illuminate\Foundation\Bootstrap\RegisterProviders::class 负责，该类用于加载所有服务提供器的 register 函数，并保存延迟加载的服务的信息，以便实现延迟加载。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">class RegisterProviders</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="keyword">function</span> bootstrap(Application <span class="variable">$app</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        //调用了Application的registerConfiguredProviders()</span><br><span class="line">        <span class="variable">$app</span>-&gt;registerConfiguredProviders();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">class Application extends Container implements ApplicationContract, HttpKernelInterface</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="keyword">function</span> registerConfiguredProviders()</span><br><span class="line">    &#123;</span><br><span class="line">        (new ProviderRepository(<span class="variable">$this</span>, new Filesystem, <span class="variable">$this</span>-&gt;getCachedServicesPath()))</span><br><span class="line">                    -&gt;load(<span class="variable">$this</span>-&gt;config[<span class="string">'app.providers'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public <span class="keyword">function</span> getCachedServicesPath()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> <span class="variable">$this</span>-&gt;bootstrapPath().<span class="string">'/cache/services.php'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以看出，所有服务提供器都在配置文件 app.php 文件的 providers 数组中。类 ProviderRepository 负责所有的服务加载功能：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class ProviderRepository</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="keyword">function</span> load(array <span class="variable">$providers</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$manifest</span> = <span class="variable">$this</span>-&gt;loadManifest();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$this</span>-&gt;shouldRecompile(<span class="variable">$manifest</span>, <span class="variable">$providers</span>)) &#123;</span><br><span class="line">            <span class="variable">$manifest</span> = <span class="variable">$this</span>-&gt;compileManifest(<span class="variable">$providers</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        foreach (<span class="variable">$manifest</span>[<span class="string">'when'</span>] as <span class="variable">$provider</span> =&gt; <span class="variable">$events</span>) &#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;registerLoadEvents(<span class="variable">$provider</span>, <span class="variable">$events</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        foreach (<span class="variable">$manifest</span>[<span class="string">'eager'</span>] as <span class="variable">$provider</span>) &#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;app-&gt;register(<span class="variable">$provider</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$this</span>-&gt;app-&gt;addDeferredServices(<span class="variable">$manifest</span>[<span class="string">'deferred'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>loadManifest()会加载服务提供器缓存文件services.php，如果框架是第一次启动时没有这个文件的，或者是缓存文件中的providers数组项与config/app.php里的providers数组项不一致都会编译生成services.php。</p>
<p>//判断是否需要编译生成services文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">function</span> shouldRecompile(<span class="variable">$manifest</span>, <span class="variable">$providers</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">return</span> is_null(<span class="variable">$manifest</span>) || <span class="variable">$manifest</span>[<span class="string">'providers'</span>] != <span class="variable">$providers</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>//编译生成文件的具体过程<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">protected <span class="keyword">function</span> compileManifest(<span class="variable">$providers</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$manifest</span> = <span class="variable">$this</span>-&gt;freshManifest(<span class="variable">$providers</span>);</span><br><span class="line">    foreach (<span class="variable">$providers</span> as <span class="variable">$provider</span>) &#123;</span><br><span class="line">        <span class="variable">$instance</span> = <span class="variable">$this</span>-&gt;createProvider(<span class="variable">$provider</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$instance</span>-&gt;isDeferred()) &#123;</span><br><span class="line">            foreach (<span class="variable">$instance</span>-&gt;provides() as <span class="variable">$service</span>) &#123;</span><br><span class="line">                <span class="variable">$manifest</span>[<span class="string">'deferred'</span>][<span class="variable">$service</span>] = <span class="variable">$provider</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$manifest</span>[<span class="string">'when'</span>][<span class="variable">$provider</span>] = <span class="variable">$instance</span>-&gt;when();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$manifest</span>[<span class="string">'eager'</span>][] = <span class="variable">$provider</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$this</span>-&gt;writeManifest(<span class="variable">$manifest</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">protected <span class="keyword">function</span> freshManifest(array <span class="variable">$providers</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">return</span> [<span class="string">'providers'</span> =&gt; <span class="variable">$providers</span>, <span class="string">'eager'</span> =&gt; [], <span class="string">'deferred'</span> =&gt; []];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>缓存文件中 providers 放入了所有自定义和框架核心的服务。<br>如果服务提供器是需要立即注册的，那么将会放入缓存文件中 eager 数组中。<br>如果服务提供器是延迟加载的，那么其函数 provides() 通常会提供服务别名，这个服务别名通常是向服务容器中注册的别名，别名将会放入缓存文件的 deferred 数组中，与真正要注册的服务提供器组成一个键值对。<br>延迟加载如果由 event 事件激活，那么可以在 when 函数中写入事件类，并写入缓存文件的 when 数组中。<br>生成的缓存文件内容如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">array (</span><br><span class="line">    <span class="string">'providers'</span> =&gt; </span><br><span class="line">    array (</span><br><span class="line">      0 =&gt; <span class="string">'Illuminate\\Auth\\AuthServiceProvider'</span>,</span><br><span class="line">      1 =&gt; <span class="string">'Illuminate\\Broadcasting\\BroadcastServiceProvider'</span>,</span><br><span class="line">      ...</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">	<span class="string">'eager'</span> =&gt; </span><br><span class="line">	array (</span><br><span class="line">      0 =&gt; <span class="string">'Illuminate\\Auth\\AuthServiceProvider'</span>,</span><br><span class="line">      1 =&gt; <span class="string">'Illuminate\\Cookie\\CookieServiceProvider'</span>,</span><br><span class="line">      ...</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    <span class="string">'deferred'</span> =&gt; </span><br><span class="line">    array (</span><br><span class="line">      <span class="string">'Illuminate\\Broadcasting\\BroadcastManager'</span> =&gt; <span class="string">'Illuminate\\Broadcasting\\BroadcastServiceProvider'</span>,</span><br><span class="line">      <span class="string">'Illuminate\\Contracts\\Broadcasting\\Factory'</span> =&gt; <span class="string">'Illuminate\\Broadcasting\\BroadcastServiceProvider'</span>,</span><br><span class="line">      ...</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    <span class="string">'when'</span> =&gt; </span><br><span class="line">    array (</span><br><span class="line">      <span class="string">'Illuminate\\Broadcasting\\BroadcastServiceProvider'</span> =&gt; </span><br><span class="line">      array (</span><br><span class="line">      ),</span><br><span class="line">      ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>事件触发时注册延迟服务提供器<br>延迟服务提供器除了利用 IOC 容器解析服务方式激活，还可以利用 Event 事件来激活：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">protected <span class="keyword">function</span> registerLoadEvents(<span class="variable">$provider</span>, array <span class="variable">$events</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (count(<span class="variable">$events</span>) &lt; 1) &#123;</span><br><span class="line">        <span class="built_in">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$this</span>-&gt;app-&gt;make(<span class="string">'events'</span>)-&gt;listen(<span class="variable">$events</span>, <span class="keyword">function</span> () use (<span class="variable">$provider</span>) &#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;app-&gt;register(<span class="variable">$provider</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>即时注册服务提供器<br>需要即时注册的服务提供器的register方法由Application的register方法里来调用：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">class Application extends Container implements ApplicationContract, HttpKernelInterface</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="keyword">function</span> register(<span class="variable">$provider</span>, <span class="variable">$options</span> = [], <span class="variable">$force</span> = <span class="literal">false</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable">$registered</span> = <span class="variable">$this</span>-&gt;getProvider(<span class="variable">$provider</span>)) &amp;&amp; ! <span class="variable">$force</span>) &#123;</span><br><span class="line">            <span class="built_in">return</span> <span class="variable">$registered</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (is_string(<span class="variable">$provider</span>)) &#123;</span><br><span class="line">            <span class="variable">$provider</span> = <span class="variable">$this</span>-&gt;resolveProvider(<span class="variable">$provider</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (method_exists(<span class="variable">$provider</span>, <span class="string">'register'</span>)) &#123;</span><br><span class="line">            <span class="variable">$provider</span>-&gt;register();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$this</span>-&gt;markAsRegistered(<span class="variable">$provider</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$this</span>-&gt;booted) &#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;bootProvider(<span class="variable">$provider</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> <span class="variable">$provider</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> getProvider(<span class="variable">$provider</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$name</span> = is_string(<span class="variable">$provider</span>) ? <span class="variable">$provider</span> : get_class(<span class="variable">$provider</span>);</span><br><span class="line">        <span class="built_in">return</span> Arr::first(<span class="variable">$this</span>-&gt;serviceProviders, <span class="keyword">function</span> (<span class="variable">$value</span>) use (<span class="variable">$name</span>) &#123;</span><br><span class="line">	        <span class="built_in">return</span> <span class="variable">$value</span> instanceof <span class="variable">$name</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> resolveProvider(<span class="variable">$provider</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        eturn new <span class="variable">$provider</span>(<span class="variable">$this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected <span class="keyword">function</span> markAsRegistered(<span class="variable">$provider</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        //这个属性在稍后booting服务时会用到</span><br><span class="line">        <span class="variable">$this</span>-&gt;serviceProviders[] = <span class="variable">$provider</span>;</span><br><span class="line">        <span class="variable">$this</span>-&gt;loadedProviders[get_class(<span class="variable">$provider</span>)] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected <span class="keyword">function</span> bootProvider(ServiceProvider <span class="variable">$provider</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (method_exists(<span class="variable">$provider</span>, <span class="string">'boot'</span>)) &#123;</span><br><span class="line">            <span class="built_in">return</span> <span class="variable">$this</span>-&gt;call([<span class="variable">$provider</span>, <span class="string">'boot'</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以看出，服务提供器的注册过程：</p>
<p>判断当前服务提供器是否被注册过，如注册过直接返回对象<br>解析服务提供器<br>调用服务提供器的 register 函数<br>标记当前服务提供器已经注册完毕<br>若框架已经加载注册完毕所有的服务容器，那么就启动服务提供器的 boot 函数，该函数由于是 call 调用，所以支持依赖注入。<br>服务解析时注册延迟服务提供器<br>延迟服务提供器首先需要添加到 Application 中<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">function</span> addDeferredServices(array <span class="variable">$services</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$this</span>-&gt;deferredServices = array_merge(<span class="variable">$this</span>-&gt;deferredServices, <span class="variable">$services</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>我们之前说过，延迟服务提供器的激活注册有两种方法：事件与服务解析。</p>
<p>当特定的事件被激发后，就会调用 Application 的 register 函数，进而调用服务提供器的 register 函数，实现服务的注册。</p>
<p>当利用 Ioc 容器解析服务名时，例如解析服务名 BroadcastingFactory：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class BroadcastServiceProvider extends ServiceProvider</span><br><span class="line">&#123;</span><br><span class="line">    protected <span class="variable">$defer</span> = <span class="literal">true</span>;</span><br><span class="line">	</span><br><span class="line">    public <span class="keyword">function</span> provides()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> [</span><br><span class="line">            BroadcastManager::class,</span><br><span class="line">            BroadcastingFactory::class,</span><br><span class="line">            BroadcasterContract::class,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在Application的make方法里会通过别名BroadcastingFactory查找是否有对应的延迟注册的服务提供器，如果有的话那么 就先通过registerDeferredProvider方法注册服务提供器。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">class Application extends Container implements ApplicationContract, HttpKernelInterface</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="keyword">function</span> make(<span class="variable">$abstract</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$abstract</span> = <span class="variable">$this</span>-&gt;getAlias(<span class="variable">$abstract</span>);</span><br><span class="line">        <span class="keyword">if</span> (isset(<span class="variable">$this</span>-&gt;deferredServices[<span class="variable">$abstract</span>])) &#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;loadDeferredProvider(<span class="variable">$abstract</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> parent::make(<span class="variable">$abstract</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> loadDeferredProvider(<span class="variable">$service</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (! isset(<span class="variable">$this</span>-&gt;deferredServices[<span class="variable">$service</span>])) &#123;</span><br><span class="line">            <span class="built_in">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      	<span class="variable">$provider</span> = <span class="variable">$this</span>-&gt;deferredServices[<span class="variable">$service</span>];</span><br><span class="line">        <span class="keyword">if</span> (! isset(<span class="variable">$this</span>-&gt;loadedProviders[<span class="variable">$provider</span>])) &#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;registerDeferredProvider(<span class="variable">$provider</span>, <span class="variable">$service</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>由 deferredServices 数组可以得知，BroadcastingFactory 为延迟服务，接着程序会利用函数 loadDeferredProvider 来加载延迟服务提供器，调用服务提供器的 register 函数，若当前的框架还未注册完全部服务。那么将会放入服务启动的回调函数中，以待服务启动时调用：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public <span class="keyword">function</span> registerDeferredProvider(<span class="variable">$provider</span>, <span class="variable">$service</span> = null)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$service</span>) &#123;</span><br><span class="line">        <span class="built_in">unset</span>(<span class="variable">$this</span>-&gt;deferredServices[<span class="variable">$service</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$this</span>-&gt;register(<span class="variable">$instance</span> = new <span class="variable">$provider</span>(<span class="variable">$this</span>));</span><br><span class="line">    <span class="keyword">if</span> (! <span class="variable">$this</span>-&gt;booted) &#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;booting(<span class="keyword">function</span> () use (<span class="variable">$instance</span>) &#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;bootProvider(<span class="variable">$instance</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>还是拿服务提供器BroadcastServiceProvider来举例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">class BroadcastServiceProvider extends ServiceProvider</span><br><span class="line">&#123;</span><br><span class="line">    protected <span class="variable">$defer</span> = <span class="literal">true</span>;</span><br><span class="line">    public <span class="keyword">function</span> register()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;app-&gt;singleton(BroadcastManager::class, <span class="keyword">function</span> (<span class="variable">$app</span>) &#123;</span><br><span class="line">            <span class="built_in">return</span> new BroadcastManager(<span class="variable">$app</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="variable">$this</span>-&gt;app-&gt;singleton(BroadcasterContract::class, <span class="keyword">function</span> (<span class="variable">$app</span>) &#123;</span><br><span class="line">            <span class="built_in">return</span> <span class="variable">$app</span>-&gt;make(BroadcastManager::class)-&gt;connection();</span><br><span class="line">        &#125;);</span><br><span class="line">        //将BroadcastingFactory::class设置为BroadcastManager::class的别名</span><br><span class="line">        <span class="variable">$this</span>-&gt;app-&gt;<span class="built_in">alias</span>(</span><br><span class="line">            BroadcastManager::class, BroadcastingFactory::class</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">function</span> provides()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> [</span><br><span class="line">            BroadcastManager::class,</span><br><span class="line">            BroadcastingFactory::class,</span><br><span class="line">            BroadcasterContract::class,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>函数 register 为类 BroadcastingFactory 向 服务容器绑定了特定的实现类 BroadcastManager，Application中的 make 函数里执行parent::make($abstract) 通过服务容器的make就会正确的解析出服务 BroadcastingFactory。</p>
<p>因此函数 provides() 返回的元素一定都是 register() 向 服务容器中绑定的类名或者别名。这样当我们利用App::make() 解析这些类名的时候，服务容器才会根据服务提供器的 register() 函数中绑定的实现类，正确解析出服务功能。</p>
<p>启动Application</p>
<p>Application的启动由类 \Illuminate\Foundation\Bootstrap\BootProviders 负责：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">class BootProviders</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="keyword">function</span> bootstrap(Application <span class="variable">$app</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$app</span>-&gt;boot();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Application extends Container implements ApplicationContract, HttpKernelInterface</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="keyword">function</span> boot()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$this</span>-&gt;booted) &#123;</span><br><span class="line">            <span class="built_in">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$this</span>-&gt;fireAppCallbacks(<span class="variable">$this</span>-&gt;bootingCallbacks);</span><br><span class="line">        array_walk(<span class="variable">$this</span>-&gt;serviceProviders, <span class="keyword">function</span> (<span class="variable">$p</span>) &#123;</span><br><span class="line">            <span class="variable">$this</span>-&gt;bootProvider(<span class="variable">$p</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="variable">$this</span>-&gt;booted = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable">$this</span>-&gt;fireAppCallbacks(<span class="variable">$this</span>-&gt;bootedCallbacks);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    protected <span class="keyword">function</span> bootProvider(ServiceProvider <span class="variable">$provider</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (method_exists(<span class="variable">$provider</span>, <span class="string">'boot'</span>)) &#123;</span><br><span class="line">            <span class="built_in">return</span> <span class="variable">$this</span>-&gt;call([<span class="variable">$provider</span>, <span class="string">'boot'</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>引导应用Application的serviceProviders属性中记录的所有服务提供器，就是依次调用这些服务提供器的boot方法，引导完成后$this-&gt;booted = true 就代表应用Application正式启动了，可以开始处理请求了。这里额外说一句，之所以等到所有服务提供器都注册完后再来进行引导是因为有可能在一个服务提供器的boot方法里调用了其他服务提供器注册的服务，所以需要等到所有即时注册的服务提供器都register完成后再来boot。</p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2018/10/11/laravel学习之Facades/">laravel学习之Facades</a><a class="next" href="/2018/10/09/laravel学习之服务容器/">laravel学习之服务容器</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://blog.xhzyxed.cn"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/408/">408</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/http/">http</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/memcached/">memcached</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web安全/">web安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端构建工具/">前端构建工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/推文/">推文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/项目/">项目</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/10/17/laravel学习之路由/">laravel学习之路由</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/14/laravel学习之中间件/">laravel学习之中间件</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/11/laravel学习之Facades/">laravel学习之Facades</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/10/laravel学习之服务提供者/">laravel学习之服务提供者</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/09/laravel学习之服务容器/">laravel学习之服务容器</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/09/laravel请求到响应的整个过程/">laravel请求到响应的整个过程</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/09/​类的反射和依赖注入/">​类的反射和依赖注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/06/秒杀系统学习/">秒杀系统学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/06/laravel框架学习之涉及到的设计模式/">laravel框架学习之重要的设计模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/06/laravel框架学习之需要了解的php基础/">laravel框架学习之需要了解的php基础</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://org.xhzyxed.cn/" title="小猴子与小耳朵" target="_blank">小猴子与小耳朵</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">其斤.匕禾页.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>