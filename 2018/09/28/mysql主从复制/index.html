<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="努力，奋斗！"><title>mysql主从复制 | 其斤.匕禾页</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">mysql主从复制</h1><a id="logo" href="/.">其斤.匕禾页</a><p class="description">永远相信美好的事情即将发生</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="https://blog.xhzyxed.cn/2018/10/02/lnmp技术栈文章汇总/"><i class="fa fa-archive"> LNMP技术栈</i></a><a href="https://blog.xhzyxed.cn/2018/10/02/速读laravel源码/"><i class="fa fa-archive"> laravel框架学习</i></a><a href="https://blog.xhzyxed.cn/2018/09/22/408基础/"><i class="fa fa-archive"> 计算机基础</i></a><a href="https://blog.xhzyxed.cn/2018/09/17/resume/"><i class="fa fa-user"> resume</i></a><a href="https://www.xhzyxed.cn/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">mysql主从复制</h1><div class="post-meta">Sep 28, 2018<span> | </span><span class="category"><a href="/categories/mysql/">mysql</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#主从复制"><span class="toc-number">1.</span> <span class="toc-text">主从复制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#作用"><span class="toc-number">2.</span> <span class="toc-text">作用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#原理"><span class="toc-number">3.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#步骤"><span class="toc-number">4.</span> <span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#实际配置"><span class="toc-number">5.</span> <span class="toc-text">实际配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#日志格式"><span class="toc-number">6.</span> <span class="toc-text">日志格式</span></a></li></ol></div></div><div class="post-content"><p>主从复制没什么复杂，了解一下</p>
<a id="more"></a>
<h1 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h1><p>主从复制，是用来建立一个和主数据库完全一样的数据库环境，称为从数据库；主数据库一般是准实时的业务数据库。</p>
<h1 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h1><ul>
<li>做数据的热备，作为后备数据库，主数据库服务器故障后，可切换到从数据库继续工作，避免数据丢失。</li>
<li>架构的扩展。业务量越来越大，I/O访问频率过高，单机无法满足，此时做多库的存储，降低磁盘I/O访问的频率，提高单个机器的I/O性能</li>
<li>读写分离，使数据库能支撑更大的并发。很多互联网公司都用到了这个。</li>
</ul>
<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><ul>
<li>1:主服务器凡运行语句,都产生一个二进制日志 binlog</li>
<li>2:从服务器不断读取主服务器的binlog</li>
<li>3:从主服务读取到的binlog,转换为自身可执行的relaylog,</li>
<li>4:执行relaylog</li>
</ul>
<h1 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h1><ul>
<li><p>1:首先确保主服务器打开二进制日志功能.<br>这样,主服务器一旦有数据变化,立即产生二进制日志.</p>
</li>
<li><p>2:从服务器也需要开启二进制日志和relay日志功能.<br>这样可以从主服务器读取binlog,并产生relaylog</p>
</li>
<li><p>3:在主服务器建立一个从服务器的账号,并授予数得上权限.</p>
</li>
<li><p>4: 指定从服务对应的主服务器,开启从服务器</p>
</li>
</ul>
<h1 id="实际配置"><a href="#实际配置" class="headerlink" title="实际配置"></a>实际配置</h1><p>可参考这篇<a href="https://www.cnblogs.com/a8457013/p/7819018.html" target="_blank" rel="noopener">文章</a></p>
<h1 id="日志格式"><a href="#日志格式" class="headerlink" title="日志格式"></a>日志格式</h1><p>主服务器的日志格式用哪种好?<br>有 statement,row, mixed3种,其中mixed是指前2种的混合.</p>
<ul>
<li>row</li>
</ul>
<p>以insert into xxtable values (x,y,z)为例,<br>影响: 1行,且为新增1行, 对于其他行没有影响.<br>这个情况,用row格式,直接复制磁盘上1行的新增变化.</p>
<p>以update xxtable set age=21 where name=’sss’;<br>这个情况,一般也只是影响1行. 用row也比较合适.</p>
<ul>
<li>statment</li>
</ul>
<p>以过年发红包,全公司的人,都涨薪100元.<br>update xxtable set salary=salary+100;<br>这个语句带来的影响,是针对每一行的, 因此磁盘上很多row都发生了变化.<br>此处,适合就statment格式的日志.</p>
<ul>
<li>mixed<br>2种日志,各有各的高效的地方,mysql提供了mixed类型.<br>可以根据语句的不同,而自动选择适合的日志格式.</li>
</ul>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2018/09/29/mysql主主复制/">mysql主主复制</a><a class="next" href="/2018/09/28/使用docker部署快速部署wordpress/">使用docker部署快速部署wordpress</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://blog.xhzyxed.cn"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/408/">408</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/http/">http</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/memcached/">memcached</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web安全/">web安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端构建工具/">前端构建工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/推文/">推文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/项目/">项目</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/10/06/laravel框架学习之涉及到的设计模式/">laravel框架学习之重要的设计模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/06/laravel框架学习之需要了解的php基础/">laravel框架学习之需要了解的php基础</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/05/laravel组件化/">laravel框架学习之组件化</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/03/Linux服务性能分析/">Linux服务器性能分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/02/速读laravel源码/">laravel框架学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/02/lnmp技术栈文章汇总/">lnmp技术栈文章汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/01/高性能mysql学习笔记-查询性能优化/">高性能mysql学习笔记-查询性能优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/29/mysql优化之sql语句优化脑图/">mysql优化之sql语句优化脑图</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/29/mysql事务/">mysql事务</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/29/mysql表分区/">mysql表分区</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://org.xhzyxed.cn/" title="小猴子与小耳朵" target="_blank">小猴子与小耳朵</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">其斤.匕禾页.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>